using UnityEngine;
using System.Collections;
using UnityEngine.Events;

public class InvulnerabilityImpact : MonoBehaviour
{
    [SerializeField] private float invulTime;
    [SerializeField] private AudioSource dome_Sound;

    [HideInInspector] public UnityEvent IsActive;

    public float InvulTime => invulTime;

    private void Awake()
    {
        // передать время действия эффекта
        UI_GameHUD gameHUD = FindObjectOfType<UI_GameHUD>();
        gameHUD.transform.GetChild(0).GetChild(4).GetComponent<UI_BonusBar>().BarTimer = invulTime;

        IsActive.Invoke();
        dome_Sound.Play();

        StartCoroutine(ChangeBackAfterDelay(invulTime));
    }

    private IEnumerator ChangeBackAfterDelay(float delay)
    {
        yield return new WaitForSeconds(delay);

        Cart cart = FindObjectOfType<Cart>();

        Invulnerability invul = FindObjectOfType<Invulnerability>();

        Destroy(invul.gameObject);

        cart.IsInvuled = false;

        Destroy(gameObject);
    }
}